<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" SYSTEM "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<title>Set User Timebase  - Legato Docs</title>
<meta content="legatoâ„¢ is an open source Linux-based embedded platform designed to simplify connected IoT application development" name="description" />
<meta content="#keywords" name="keywords" />
<meta content="noindex, nofollow" name="robots" />
<meta content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
<link href="/resources/images/legato.ico" rel="shortcut icon" />
<link href="#" rel="apple-touch-icon" />
<link href="#" rel="apple-touch-icon" sizes="72x72" />
<link href="#" rel="apple-touch-icon" sizes="114x114" />
<link href="/resources/css/style.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/resources/css/font-awesome.css" rel="stylesheet" type="text/css" />
<!--[if IE]>
        <script src="/resources/js/html5shiv.js"></script>
        <script src="/resources/js/respond.js"></script>
        <![endif]-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script src="/resources/js/main.js"></script>
<link href="/resources/css/jqtree.css" rel="stylesheet" type="text/css" />
<script src="/resources/js/tree.jquery.js" type="text/javascript"></script>
<script src="/resources/js/jquery.cookie.js"></script>
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
<script>
        setupTree("/resources/tocs/Learn.json");
        </script>
</head>
<body>
<div class="wrapper">
<div class="fa fa-bars documentation" id="menu-trigger"></div>
<div id="top">
<header>
<nav>
<a class="navlink" href="/index.html">Introduction</a><a class="navlink" href="/partners/">Partners</a><a class="navlink" href="/apps/">Build Apps</a><a class="subnavlink" href="/apps/intro">Introduction</a><a class="subnavlink" href="/apps/getstarted">Get started</a><a class="subnavlink" href="/apps/docs/learn">Documentation</a><a class="subnavlink" href="/apps/community">Community</a><a class="subnavlink" href="/apps/license">License</a><a class="navlink" href="/platform/">Build Platform</a><a class="subnavlink" href="/platform/">Introduction</a><a class="subnavlink" href="/platform/">Get started</a><a class="subnavlink" href="/platform/docs">Documentation</a><a class="subnavlink" href="/platform/">Community</a><a class="subnavlink" href="/platform/">License</a>
</nav>
</header>
</div>
<div id="menudocumentation">
<header>
<h1><a class="navlink" href="/" title="back to Legato homepage">Legato</a></h1>
<h2>/ Build Apps Documentation</h2>
<nav class="ui-front" id="searchresult">
<a href="/apps/docs/learn/">Learn</a><a href="/apps/docs/converted/">Converted API</a><a href="/apps/docs/api/">API Guides</a><a href="/apps/docs/tools/">Tools</a><a href="/apps/docs/reference/">Reference</a>
<i class="fa fa-search"></i>
<input id="autocomplete" onkeyup="getdata()" /> <!-- <input id="category" type="checkbox" onclick="checkbox()"> <label for="category">API Search</label> -->
<ul class="ui-autocomplete ui-front ui-menu ui-widget ui-widget-content" id="search_result" tabindex="0"></ul>
</nav>
</header>
</div>
<div id="topMenu">
<a class="biglink" href="/apps/docs/">App docs</a>
<nav>
<a href="getstarted_main.html">Get Started</a><a class="link-selected" href="learn_main.html">Learn</a><a href="api_guides_main.html">API Guides</a><a href="tools.html">Tools</a><a href="files.html">Reference</a>
</nav>
</div>
<div id="left">
<div id="tree1"></div>
</div>
<div class="content">
<div class="header">
<div class="headertitle">
<h1 class="title">Set User Timebase </h1> </div>
</div><div class="contents">
<div class="textblock"><p>This topic provides details on setting the user timebase. Usually, the automated time daemon handles time synchronization, but that may not always be desirable.</p>
<p>See <a class="el" href="c_rtc.html">User Timebase</a> API</p>
<hr />
<p>You never directly modify the RTC. Instead, a user timebase parses the time values needed to adjust the RTC (plus/minus) so it's synchronized with the system clock.</p>
<p>This is how time synchronization works in Legato:</p>
<div class="image">
<img alt="le_rtc.png" src="le_rtc.png" />
</div>
<h1><a class="anchor" id="howToSetUserTimebase_overview"></a>
Overview</h1>
<p>The modem manages a real time clock (battery backed clock VCOIN) that keeps time when the power is removed from the Legato module (if clock battery available). This clock is used by the modem to maintain several timebases derived from different domains (e.g., cellular or GPS). Apps shouldn't directly change the value of the real time clock as it may have undesirable effects on modem function.</p>
<p>The user timebase is provided to synchronize with the RTC. An arbitrary stored time will increment on a millisecond basis and can be retrieved later assuming a battery (VCOIN) is available to keep the RTC running.</p>
<h1><a class="anchor" id="howToSetUserTimebase_getandset"></a>
Get/Set User Timebase</h1>
<p>If you need to set the user timebase, you need to <a class="el" href="c_rtc.html#c_rtc_disableDaemon">Disable Time Daemon</a> and then <a class="el" href="c_rtc.html#c_rtc_getSet">Get/Set Time Value</a>.</p>
<p>See <a class="el" href="c_rtc.html">User Timebase</a> and <a class="el" href="c_clock.html">System Clock API</a>.</p>
<h1><a class="anchor" id="howToSetUserTimebase_background"></a>
Background</h1>
<p>The RTC counts milliseconds since the GPS Epoch (January 6, 1980) and increments on each count so that each second in GPS time has a unique number. Unix time starts January 1, 1970, and has a fixed number of seconds per day. In Unix, days that have an extra second in them (i.e., leap second) use the same second twice. This means that over time an ever increasing number of leap seconds have to be accounted for when converting time between domains.</p>
<p>Leap seconds are introduced periodically because astronomically measured time and clock time would drift apart unless adjustments are made. It also means that Unix time, GPS time, and clock time are all drifting apart as well. The rate of drift is low (only 26 leap seconds have been added since leap seconds were introduced in 1972). It's impossible to predict in which years leap seconds will be added so that calculation must be done retroactively, based on observation.</p>
<p>For practical purposes, it's not necessary to convert the time you wish to maintain into real GPS time; it will suffice to use Unix epoch time. The amount of drift caused by leap seconds over a year is less than the inherent drift in the RTC. Under normal conditions, the time will be corrected from an external source like network time or GPS.</p>
<hr />
</div></div>
<br clear="left" />
</div>
<div id="footer">
</div>
</div>
</body>
</html>