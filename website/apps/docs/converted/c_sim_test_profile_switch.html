<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Legato - Build Apps - Documentation</title>
	<meta name="description" content="legato™ is an open source Linux-based embedded platform designed to simplify connected IoT application development" />
	<meta name="keywords" content="#keywords" />
	<meta name="robots" content="noindex, nofollow" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" href="/resources/images/legato.ico">
    <link rel="apple-touch-icon" href="#">
    <link rel="apple-touch-icon" sizes="72x72" href="#">
    <link rel="apple-touch-icon" sizes="114x114" href="#">
    <link rel="stylesheet" type="text/css" href="/resources/css/style.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/resources/css/font-awesome.css">
    
    <!--[if IE]>
    <script src="/resources/js/html5shiv.js"></script>
    <script src="/resources/js/respond.js"></script>
    <![endif]-->
    
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>

    <script src="/resources/js/main.js"></script>    
    <link rel="stylesheet" type="text/css" href="/resources/css/jqtree.css">
    <script type="text/javascript" src="/resources/js/tree.jquery.js"></script>
    <script>
    setupTree();
    </script>
</head>
<body>
    <div class="wrapper">
    	<div id="menu-trigger" class="fa fa-bars documentation"></div>
        <div id="top">
            <header>
                <nav>
                    <a href="/index.html"class="navlink">Introduction</a><a href="/partners/"class="navlink">Partners</a><a href="/apps/"class="navlink">Build Apps</a><a href="/apps/intro"class="subnavlink">Introduction</a><a href="/apps/getstarted"class="subnavlink">Get started</a><a href="/apps/docs/learn"class="subnavlink">Documentation</a><a href="/apps/community"class="subnavlink">Community</a><a href="/apps/license"class="subnavlink">License</a><a href="/platform/"class="navlink">Build Platform</a><a href="/platform/"class="subnavlink">Introduction</a><a href="/platform/"class="subnavlink">Get started</a><a href="/platform/docs"class="subnavlink">Documentation</a><a href="/platform/"class="subnavlink">Community</a><a href="/platform/"class="subnavlink">License</a>
                </nav>
            </header>
        </div>
        <div id="menudocumentation">
	<header>
		<h1><a title="back to Legato homepage" href="/" class="navlink">Legato</a></h1>
		<h2>/ Build Apps Documentation</h2>
		<nav>
			<a href="/apps/docs/learn/">Learn</a><a href="/apps/docs/api/">API Guides</a><a href="/apps/docs/tools/">Tools</a><a href="/apps/docs/reference/">Reference</a>
			<i class="fa fa-search"></i>
			<input id="autocomplete" onkeyup="getdata()"> <!-- <input id="category" type="checkbox" onclick="checkbox()"> <label for="category">API Search</label> -->
		<ul id="search_result" class="ui-autocomplete ui-front ui-menu ui-widget ui-widget-content" tabindex="0"></ul>
	</nav>
</header>
</div>

        <div id="topMenu">
	<a href=/apps/docs/converted/ class="biglink">App docs?</a>
	<nav>
	<a href="/apps/docs/converted/" class="link-selected">Converted documentation</a><a href="sample-apps.html">Sample Apps</a><a href="how-tos.html">How Tos</a><a href="def-files.html">Definition Files</a>
	</nav>
</div>
        <div id="left">
        	<div id="tree1">Loading nav tree...</div>
        </div>

        <div class="content">
            <div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark"> </span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark"> </span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark"> </span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark"> </span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark"> </span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark"> </span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark"> </span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark"> </span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark"> </span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark"> </span>Pages</a></div>
<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)">
</iframe>
</div>
<div class="header">
<div class="headertitle">
<div class="title">Sample code for Local SIM profile switch </div> </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="fragment"><div class="line"></div>
<div class="line"><span class="preprocessor">#include "<a class="code" href="legato_8h.html">legato.h</a>"</span></div>
<div class="line"><span class="preprocessor">#include "interfaces.h"</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <a class="code" href="le__sim__interface_8h.html#a3d8f90603c8f5ff03b30fe9fabdf37f2">le_sim_SimToolkitEventHandlerRef_t</a>   StkHandlerRef = NULL;</div>
<div class="line"><span class="keyword">static</span> <a class="code" href="le__sim__interface_8h.html#a2762b1c04a51b185890700b0fa94f92d">le_sim_NewStateHandlerRef_t</a>          HandlerRef = NULL;</div>
<div class="line"><span class="keyword">static</span> <a class="code" href="le__sim__interface_8h.html#aace49df88426119626fb1ef4e544ccdd">le_sim_Id_t</a>                          SimIdSelect = <a class="code" href="le__sim__interface_8h.html#aace49df88426119626fb1ef4e544ccdda4270fb44e8fa7876f337864675b42f2d">LE_SIM_EXTERNAL_SLOT_1</a>;</div>
<div class="line"><span class="keyword">static</span> <a class="code" href="le__sim__interface_8h.html#ac9719aa7561f79bc0b51eca9447ff37e">le_sim_Manufacturer_t</a>                Manufacturer = <a class="code" href="le__sim__interface_8h.html#ac9719aa7561f79bc0b51eca9447ff37ea463b0b396f8c8f3b1dff4c1b6facb451">LE_SIM_GEMALTO</a>;</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>*                          Profile = NULL;</div>
<div class="line"></div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> TestSimToolkitHandler</div>
<div class="line">(</div>
<div class="line"> <a class="code" href="le__sim__interface_8h.html#aace49df88426119626fb1ef4e544ccdd">le_sim_Id_t</a>       simId,</div>
<div class="line"> <a class="code" href="le__sim__interface_8h.html#a7c53ab7f9f004387ef41e80df1121da2">le_sim_StkEvent_t</a> stkEvent,</div>
<div class="line"> <span class="keywordtype">void</span>*             contextPtr</div>
<div class="line">)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">switch</span>(stkEvent)</div>
<div class="line">    {</div>
<div class="line"> <span class="keywordflow">case</span> <a class="code" href="le__sim__interface_8h.html#a7c53ab7f9f004387ef41e80df1121da2a7207480abc036ae29469da1801033b2d">LE_SIM_OPEN_CHANNEL</a>:</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"-TEST- OPEN_CHANNEL SIM Toolkit event for SIM card.%d"</span>, simId);</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line"> <span class="keywordflow">case</span> <a class="code" href="le__sim__interface_8h.html#a7c53ab7f9f004387ef41e80df1121da2a4e4be9cfce6ef2e0832d707820cd106d">LE_SIM_REFRESH</a>:</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"-TEST- REFRESH SIM Toolkit event for SIM card.%d"</span>, simId);</div>
<div class="line"> <a class="code" href="le__log_8h.html#aceaf11a11691d6c676e36dd317b38dbd">LE_ERROR_IF</a>((<a class="code" href="le__sim__interface_8h.html#a8cc75a17466446c19c5bd941b1360e0e">le_sim_AcceptSimToolkitCommand</a>(simId) != LE_OK),</div>
<div class="line"> <span class="stringliteral">"Accept SIM Toolkit failure!"</span>);</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line"> <span class="keywordflow">case</span> <a class="code" href="le__sim__interface_8h.html#a7c53ab7f9f004387ef41e80df1121da2aa086ea0a94ca7065b6baf974e11ed707">LE_SIM_STK_EVENT_MAX</a>:</div>
<div class="line"> <span class="keywordflow">default</span>:</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"-TEST- Unknown SIM Toolkit event %d for SIM card.%d"</span>, stkEvent, simId);</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> TestSimStateHandler</div>
<div class="line">(</div>
<div class="line"> <a class="code" href="le__sim__interface_8h.html#aace49df88426119626fb1ef4e544ccdd">le_sim_Id_t</a>     simId,</div>
<div class="line"> <a class="code" href="le__sim__interface_8h.html#a21b9bb7d5e5e7ece213e00738a5bae41">le_sim_States_t</a> simState,</div>
<div class="line"> <span class="keywordtype">void</span>*           contextPtr</div>
<div class="line">)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">switch</span>(simState)</div>
<div class="line">    {</div>
<div class="line"> <span class="keywordflow">case</span> <a class="code" href="le__sim__interface_8h.html#a21b9bb7d5e5e7ece213e00738a5bae41a86aea853ae5fcc1a2e3c8d352d8689d3">LE_SIM_INSERTED</a>:</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"-TEST- New state LE_SIM_INSERTED for SIM card.%d"</span>, simId);</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line"> <span class="keywordflow">case</span> <a class="code" href="le__sim__interface_8h.html#a21b9bb7d5e5e7ece213e00738a5bae41a813e26946372fbc3960aa97713b6ca2f">LE_SIM_ABSENT</a>:</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"-TEST- New state LE_SIM_ABSENT for SIM card.%d"</span>, simId);</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line"> <span class="keywordflow">case</span> <a class="code" href="le__sim__interface_8h.html#a21b9bb7d5e5e7ece213e00738a5bae41aa7f1f6c3391e32af8ce3ba2242276d64">LE_SIM_READY</a>:</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"-TEST- New state LE_SIM_READY for SIM card.%d"</span>, simId);</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line"> <span class="keywordflow">case</span> <a class="code" href="le__sim__interface_8h.html#a21b9bb7d5e5e7ece213e00738a5bae41af83b91131d516ad3756781108000515a">LE_SIM_BLOCKED</a>:</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"-TEST- New state LE_SIM_BLOCKED for SIM card.%d"</span>, simId);</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line"> <span class="keywordflow">case</span> <a class="code" href="le__sim__interface_8h.html#a21b9bb7d5e5e7ece213e00738a5bae41a944435801d6359050dc37092396ca951">LE_SIM_BUSY</a>:</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"-TEST- New state LE_SIM_BUSY for SIM card.%d"</span>, simId);</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line"> <span class="keywordflow">case</span> <a class="code" href="le__sim__interface_8h.html#a21b9bb7d5e5e7ece213e00738a5bae41ad82522676bf094ea402a0311356e434f">LE_SIM_STATE_UNKNOWN</a>:</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"-TEST- New state LE_SIM_STATE_UNKNOWN for SIM card.%d"</span>, simId);</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line"> <span class="keywordflow">default</span>:</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"-TEST- New state %d for SIM card.%d"</span>, simState, simId);</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="keywordtype">void</span> Testle_sim_GetCurrentSubscription</div>
<div class="line">(</div>
<div class="line"> <span class="keywordtype">void</span></div>
<div class="line">)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">bool</span> isEcs;</div>
<div class="line"> <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86c">le_result_t</a> res = <a class="code" href="le__sim__interface_8h.html#a837cdc0fe30761f4339f846a0b44c5f1">le_sim_IsEmergencyCallSubscriptionSelected</a>(SimIdSelect, &isEcs);</div>
<div class="line"></div>
<div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(res != <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86cac409634423b6b1ef09643529f6224798">LE_FAULT</a>);</div>
<div class="line"> <span class="keywordflow">if</span>(res == <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca77a7505b0443df2fa1bab375c7267637">LE_NOT_FOUND</a>)</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Cannot determine current subscription"</span>);</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">else</span> <span class="keywordflow">if</span> (res == LE_OK)</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Current subscription is %s"</span>, (isEcs ? <span class="stringliteral">"ECS"</span>:<span class="stringliteral">"Commercial"</span>));</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="keywordtype">void</span> Testle_sim_SwapToEcs</div>
<div class="line">(</div>
<div class="line"> <span class="keywordtype">void</span></div>
<div class="line">)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">bool</span> isEcs;</div>
<div class="line"></div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Start Testle_sim_SwapToEcs"</span>);</div>
<div class="line"></div>
<div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(<a class="code" href="le__sim__interface_8h.html#aa856f5e094e8182c8d0b07761e309549">le_sim_LocalSwapToEmergencyCallSubscription</a>(SimIdSelect, Manufacturer) == LE_OK);</div>
<div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(<a class="code" href="le__sim__interface_8h.html#a837cdc0fe30761f4339f846a0b44c5f1">le_sim_IsEmergencyCallSubscriptionSelected</a>(SimIdSelect, &isEcs) == LE_OK);</div>
<div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(isEcs == <span class="keyword">true</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="keywordtype">void</span> Testle_sim_SwapToCommercial</div>
<div class="line">(</div>
<div class="line"> <span class="keywordtype">void</span></div>
<div class="line">)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">bool</span> isEcs;</div>
<div class="line"></div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Start Testle_sim_SwapToCommercial"</span>);</div>
<div class="line"></div>
<div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(<a class="code" href="le__sim__interface_8h.html#a51b535750b66c4cf460e3c8c72f3658d">le_sim_LocalSwapToCommercialSubscription</a>(SimIdSelect, Manufacturer) == LE_OK);</div>
<div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(<a class="code" href="le__sim__interface_8h.html#a837cdc0fe30761f4339f846a0b44c5f1">le_sim_IsEmergencyCallSubscriptionSelected</a>(SimIdSelect, &isEcs) == LE_OK);</div>
<div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(isEcs == <span class="keyword">false</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> SigHandler</div>
<div class="line">(</div>
<div class="line"> <span class="keywordtype">int</span> sigNum</div>
<div class="line">)</div>
<div class="line">{</div>
<div class="line"> <a class="code" href="le__sim__interface_8h.html#a487be241cae0657f96bcc44d0f8fab5a">le_sim_RemoveSimToolkitEventHandler</a>(StkHandlerRef);</div>
<div class="line"> <a class="code" href="le__sim__interface_8h.html#a8e3a4e2e978cf4931a39317ee5e9f762">le_sim_RemoveNewStateHandler</a>(HandlerRef);</div>
<div class="line"></div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"EXIT SIM local Profile Swap Test"</span>);</div>
<div class="line">    exit(EXIT_SUCCESS);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> PrintUsage</div>
<div class="line">(</div>
<div class="line"> <span class="keywordtype">void</span></div>
<div class="line">)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">int</span> idx;</div>
<div class="line"> <span class="keywordtype">bool</span> sandboxed = (getuid() != 0);</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">char</span> * usagePtr[] =</div>
<div class="line">    {</div>
<div class="line"> <span class="stringliteral">"Usage of the simProfileSwap app is:"</span>,</div>
<div class="line"> <span class="stringliteral">"   execInApp simProfileSwap simProfileSwap <ext/esim>"</span></div>
<div class="line"> <span class="stringliteral">" <gemalto/oberthur/gd/morpho> <ecs/commercial>"</span>,</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">for</span>(idx = 0; idx < <a class="code" href="le__basics_8h.html#a8d8f28a045f43b477cafb67a99894c07">NUM_ARRAY_MEMBERS</a>(usagePtr); idx++)</div>
<div class="line">    {</div>
<div class="line"> <span class="keywordflow">if</span>(sandboxed)</div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"%s"</span>, usagePtr[idx]);</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">"%s\n"</span>, usagePtr[idx]);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> GetArgs</div>
<div class="line">(</div>
<div class="line"> <span class="keywordtype">void</span></div>
<div class="line">)</div>
<div class="line">{</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">char</span>*  arg = NULL;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Get SIM type</span></div>
<div class="line">    arg = <a class="code" href="le__args_8h.html#a5ebca8229facd069785639cb3c1e273a">le_arg_GetArg</a>(0);</div>
<div class="line"> <span class="keywordflow">if</span>( strncmp(arg, <span class="stringliteral">"ext"</span>, strlen(<span class="stringliteral">"ext"</span>)) == 0 )</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"external SIM is selected."</span>);</div>
<div class="line">        SimIdSelect = <a class="code" href="le__sim__interface_8h.html#aace49df88426119626fb1ef4e544ccdda4270fb44e8fa7876f337864675b42f2d">LE_SIM_EXTERNAL_SLOT_1</a>;</div>
<div class="line"></div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strncmp(arg, <span class="stringliteral">"esim"</span>, strlen(<span class="stringliteral">"esim"</span>)) == 0 )</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"embedded SIM is selected."</span>);</div>
<div class="line">        SimIdSelect = <a class="code" href="le__sim__interface_8h.html#aace49df88426119626fb1ef4e544ccddac9d9805213bfb9ae4d299aa70097846a">LE_SIM_EMBEDDED</a>;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        PrintUsage();</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"EXIT SIM local Profile Swap Test"</span>);</div>
<div class="line">        exit(EXIT_FAILURE);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Get Card manufacturer</span></div>
<div class="line">    arg = <a class="code" href="le__args_8h.html#a5ebca8229facd069785639cb3c1e273a">le_arg_GetArg</a>(1);</div>
<div class="line"> <span class="keywordflow">if</span>( strncmp(arg, <span class="stringliteral">"gemalto"</span>, strlen(<span class="stringliteral">"gemalto"</span>)) == 0 )</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Card manufacturer is Gemalto."</span>);</div>
<div class="line">        Manufacturer = <a class="code" href="le__sim__interface_8h.html#ac9719aa7561f79bc0b51eca9447ff37ea463b0b396f8c8f3b1dff4c1b6facb451">LE_SIM_GEMALTO</a>;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strncmp(arg, <span class="stringliteral">"oberthur"</span>, strlen(<span class="stringliteral">"oberthur"</span>)) == 0 )</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Card manufacturer is Oberthur."</span>);</div>
<div class="line">        Manufacturer = <a class="code" href="le__sim__interface_8h.html#ac9719aa7561f79bc0b51eca9447ff37ea6ba110dea48603ce2d8af48321bd5ae9">LE_SIM_OBERTHUR</a>;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strncmp(arg, <span class="stringliteral">"gd"</span>, strlen(<span class="stringliteral">"gd"</span>)) == 0 )</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Card manufacturer is G&D."</span>);</div>
<div class="line">        Manufacturer = <a class="code" href="le__sim__interface_8h.html#ac9719aa7561f79bc0b51eca9447ff37ea1037fc81733b1666116328faa4f335ef">LE_SIM_G_AND_D</a>;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strncmp(arg, <span class="stringliteral">"morpho"</span>, strlen(<span class="stringliteral">"morpho"</span>)) == 0 )</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Card manufacturer is Morpho."</span>);</div>
<div class="line">        Manufacturer = <a class="code" href="le__sim__interface_8h.html#ac9719aa7561f79bc0b51eca9447ff37ea00b929700255479a7c285328af3e16ee">LE_SIM_MORPHO</a>;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        PrintUsage();</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"EXIT SIM local Profile Swap Test"</span>);</div>
<div class="line">        exit(EXIT_FAILURE);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a class="code" href="le__event_loop_8h.html#abdb9187a56836a93d19cc793cbd4b7ec">COMPONENT_INIT</a></div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="le__args_8h.html#a6fbbeb423104e6eb92fe47ef42b7310a">le_arg_NumArgs</a>() == 3)</div>
<div class="line">    {</div>
<div class="line"> <span class="comment">// Register a signal event handler for SIGINT when user interrupts/terminates process</span></div>
<div class="line">        signal(SIGINT, SigHandler);</div>
<div class="line"></div>
<div class="line">        GetArgs();</div>
<div class="line">        Profile = <a class="code" href="le__args_8h.html#a5ebca8229facd069785639cb3c1e273a">le_arg_GetArg</a>(2);</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"======== Start SIM local Profile Swap Test with Profile.%s========"</span>, Profile);</div>
<div class="line"></div>
<div class="line">        StkHandlerRef=<a class="code" href="le__sim__interface_8h.html#a85577728a34d70801cbb4deb8efd75d5">le_sim_AddSimToolkitEventHandler</a>(TestSimToolkitHandler, NULL);</div>
<div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(StkHandlerRef!=NULL);</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span>( strncmp(Profile, <span class="stringliteral">"ecs"</span>, strlen(<span class="stringliteral">"ecs"</span>)) == 0 )</div>
<div class="line">        {</div>
<div class="line"> <span class="comment">// Add the state handler</span></div>
<div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((HandlerRef = <a class="code" href="le__sim__interface_8h.html#a8e296a7cd35edd99cb1dc21232e280dd">le_sim_AddNewStateHandler</a>(TestSimStateHandler, NULL)) != NULL);</div>
<div class="line"></div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"======== SwapToEcs Test  ========"</span>);</div>
<div class="line">            Testle_sim_GetCurrentSubscription();</div>
<div class="line">            Testle_sim_SwapToEcs();</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strncmp(Profile, <span class="stringliteral">"commercial"</span>, strlen(<span class="stringliteral">"commercial"</span>)) == 0 )</div>
<div class="line">        {</div>
<div class="line"> <span class="comment">// Add the state handler</span></div>
<div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((HandlerRef = <a class="code" href="le__sim__interface_8h.html#a8e296a7cd35edd99cb1dc21232e280dd">le_sim_AddNewStateHandler</a>(TestSimStateHandler, NULL)) != NULL);</div>
<div class="line"></div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"======== SwapToCommercial Test  ========"</span>);</div>
<div class="line">            Testle_sim_GetCurrentSubscription();</div>
<div class="line">            Testle_sim_SwapToCommercial();</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            PrintUsage();</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"EXIT SIM local Profile Swap Test"</span>);</div>
<div class="line">            exit(EXIT_FAILURE);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"======== Test SIM local Profile Swap Test SUCCESS ========"</span>);</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        PrintUsage();</div>
<div class="line"> <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"EXIT SIM local Profile Swap Test"</span>);</div>
<div class="line">        exit(EXIT_FAILURE);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
<meta content="API Guides" name="category"></meta></div>
            <br clear="left" />
        </div>
        <div id="footer">
        	Copyright © Sierra Wireless Inc. Use of this work is subject to license.
        </div>
	</div>
</body>
</html>