<div class="header">
<div class="headertitle">
<h1 class="title">Sample code for Data Statistics </h1> </div>
</div><meta content="Sample code for Data Statistics " name="title"></meta><div class="contents">
<div class="textblock"><div class="fragment"><div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div><div class="line"><span class="comment"></span><span class="comment">//--------------------------------------------------------------------------------------------------</span></div><div class="line"><span class="keywordtype">void</span> TestConnectivity</div><div class="line">(</div><div class="line"> <a class="code" href="le__mdc__interface_8h.html#a91074d8f0d88c6645e3085dfadf87011">le_mdc_ProfileRef_t</a> profileRef</div><div class="line">)</div><div class="line">{</div><div class="line"> <span class="keywordtype">char</span> systemCmd[200] = {0};</div><div class="line"> <span class="keywordtype">char</span> itfName[<a class="code" href="le__mdc__interface_8h.html#a33ebf9afd03f0ffc91a80c32c15afb42">LE_MDC_INTERFACE_NAME_MAX_BYTES</a>]=<span class="stringliteral">"\0"</span>;</div><div class="line"></div><div class="line"> <a class="code" href="le__mdc__interface_8h.html#a7a9d8c4b2053b048a53257ed810f527e">le_mdc_DataBearerTechnology_t</a> downlinkDataBearerTech;</div><div class="line"> <a class="code" href="le__mdc__interface_8h.html#a7a9d8c4b2053b048a53257ed810f527e">le_mdc_DataBearerTechnology_t</a> uplinkDataBearerTech;</div><div class="line"></div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(<a class="code" href="le__mdc__interface_8h.html#a1b17bb87b347162013b5ad608cdcda2d">le_mdc_GetDataBearerTechnology</a>(profileRef,</div><div class="line">                                             &amp;downlinkDataBearerTech,</div><div class="line">                                             &amp;uplinkDataBearerTech) == LE_OK);</div><div class="line"></div><div class="line"> <a class="code" href="le__log_8h.html#a4ebab29f40ee8eaaa87205fe3f9aaa13">LE_INFO</a>(<span class="stringliteral">"downlinkDataBearerTech %d, uplinkDataBearerTech %d"</span>,</div><div class="line">                downlinkDataBearerTech, uplinkDataBearerTech);</div><div class="line"></div><div class="line"> <span class="comment">// Get interface name</span></div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(<a class="code" href="le__mdc__interface_8h.html#abf470aa8e252114cbb95b4e337083d52">le_mdc_GetInterfaceName</a>(profileRef, itfName, <a class="code" href="le__mdc__interface_8h.html#a33ebf9afd03f0ffc91a80c32c15afb42">LE_MDC_INTERFACE_NAME_MAX_BYTES</a>)</div><div class="line">                                                                                          == LE_OK);</div><div class="line"></div><div class="line"> <span class="keywordflow">if</span> ( <a class="code" href="le__mdc__interface_8h.html#aa3912e94864a6e5862e07f58b3772cba">le_mdc_IsIPv4</a>(profileRef) )</div><div class="line">    {</div><div class="line">        snprintf(systemCmd, <span class="keyword">sizeof</span>(systemCmd), <span class="stringliteral">"ping -c 4 www.sierrawireless.com -I %s"</span>, itfName);</div><div class="line">    }</div><div class="line"> <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line"> <span class="comment">// TODO ping6 needs raw access to socket and therefore root permissions =&gt; find a different</span></div><div class="line"> <span class="comment">// way to test the connectivity</span></div><div class="line">        snprintf(systemCmd, <span class="keyword">sizeof</span>(systemCmd), <span class="stringliteral">"ping6 -c 4 www.sierrawireless.com -I %s"</span>, itfName);</div><div class="line">    }</div><div class="line"></div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(system(systemCmd) == 0);</div><div class="line"></div><div class="line"> <span class="comment">// Get data counters</span></div><div class="line">    uint64_t rxBytes=0, txBytes=0;</div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>( <a class="code" href="le__mdc__interface_8h.html#aaad833c105f7d0ae77f18195d6739080">le_mdc_GetBytesCounters</a>(&amp;rxBytes, &amp;txBytes) == LE_OK );</div><div class="line"></div><div class="line"> <a class="code" href="le__log_8h.html#a4ebab29f40ee8eaaa87205fe3f9aaa13">LE_INFO</a>(<span class="stringliteral">"rxBytes %ld, txBytes %ld"</span>, (<span class="keywordtype">long</span> <span class="keywordtype">int</span>) rxBytes, (<span class="keywordtype">long</span> <span class="keywordtype">int</span>) txBytes);</div><div class="line">}</div></div><!-- fragment --></div></div>