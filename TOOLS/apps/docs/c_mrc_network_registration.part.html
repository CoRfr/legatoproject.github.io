<div class="header">
<div class="headertitle">
<h1 class="title">Sample code for Network Registration </h1> </div>
</div><meta content="Sample code for Network Registration " name="title"></meta><div class="contents">
<div class="textblock"><div class="fragment"><div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div><div class="line"><span class="comment"></span><span class="comment">//--------------------------------------------------------------------------------------------------</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> Testle_mrc_RegisterMode()</div><div class="line">{</div><div class="line"> <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86c">le_result_t</a> res;</div><div class="line"> <span class="keywordtype">int</span> cmpRes;</div><div class="line"> <span class="keywordtype">char</span> mccHomeStr[<a class="code" href="le__mrc__interface_8h.html#aec88b97b54a45f86e6cb34f65b2d0afd">LE_MRC_MCC_BYTES</a>] = {0};</div><div class="line"> <span class="keywordtype">char</span> mccStr[<a class="code" href="le__mrc__interface_8h.html#aeae0e240c77730be724ad7ac42596469">LE_MRC_MNC_BYTES</a>] = {0};</div><div class="line"> <span class="keywordtype">char</span> mncHomeStr[<a class="code" href="le__mrc__interface_8h.html#aec88b97b54a45f86e6cb34f65b2d0afd">LE_MRC_MCC_BYTES</a>] = {0};</div><div class="line"> <span class="keywordtype">char</span> mncStr[<a class="code" href="le__mrc__interface_8h.html#aeae0e240c77730be724ad7ac42596469">LE_MRC_MNC_BYTES</a>] = {0};</div><div class="line"> <span class="keywordtype">bool</span> isManualOrigin, isManual;</div><div class="line"></div><div class="line"> <span class="comment">// Get the home PLMN to compare results.</span></div><div class="line">    res = <a class="code" href="le__sim__interface_8h.html#a048b9cc4aed3f4c2fcf6ca34f40e99a9">le_sim_GetHomeNetworkMccMnc</a>(<a class="code" href="le__sim__interface_8h.html#aace49df88426119626fb1ef4e544ccdda4270fb44e8fa7876f337864675b42f2d">LE_SIM_EXTERNAL_SLOT_1</a>, mccHomeStr, LE_MRC_MCC_BYTES,</div><div class="line">                                      mncHomeStr, LE_MRC_MNC_BYTES);</div><div class="line"> <a class="code" href="le__log_8h.html#aceaf11a11691d6c676e36dd317b38dbd">LE_ERROR_IF</a>(res != LE_OK, <span class="stringliteral">"Home PLMN can't be retrives for test case"</span>);</div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(res == LE_OK);</div><div class="line"> <a class="code" href="le__log_8h.html#a4ebab29f40ee8eaaa87205fe3f9aaa13">LE_INFO</a>(<span class="stringliteral">"Home PLMN is mcc.%s mnc.%s"</span>, mccHomeStr, mncHomeStr);</div><div class="line"></div><div class="line">    res = <a class="code" href="le__mrc__interface_8h.html#a283c0c092c5a135a8e95f9f091655cb1">le_mrc_GetRegisterMode</a>(&isManualOrigin,</div><div class="line">                    mccStr, LE_MRC_MCC_BYTES, mncStr, LE_MRC_MNC_BYTES);</div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(res == LE_OK);</div><div class="line"></div><div class="line"> <a class="code" href="le__log_8h.html#a4ebab29f40ee8eaaa87205fe3f9aaa13">LE_INFO</a>(<span class="stringliteral">"le_mrc_GetRegisterMode Manual(%c), mcc.%s mnc.%s"</span>,</div><div class="line">        (isManualOrigin ? <span class="charliteral">'Y'</span> : <span class="charliteral">'N'</span>),</div><div class="line">        mccStr, mncStr);</div><div class="line"></div><div class="line">    res = <a class="code" href="le__mrc__interface_8h.html#acb434a9f91afb5b6639baf3678ee9388">le_mrc_SetAutomaticRegisterMode</a>();</div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(res == LE_OK);</div><div class="line"></div><div class="line">    sleep(5);</div><div class="line"></div><div class="line">    memset(mccStr,0,LE_MRC_MCC_BYTES);</div><div class="line">    memset(mncStr,0,LE_MRC_MNC_BYTES);</div><div class="line">    res = <a class="code" href="le__mrc__interface_8h.html#a283c0c092c5a135a8e95f9f091655cb1">le_mrc_GetRegisterMode</a>(&isManual, mccStr, LE_MRC_MCC_BYTES, mncStr, LE_MRC_MNC_BYTES);</div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(res == LE_OK);</div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(isManual == <span class="keyword">false</span>);</div><div class="line"> <a class="code" href="le__log_8h.html#a4ebab29f40ee8eaaa87205fe3f9aaa13">LE_INFO</a>(<span class="stringliteral">"le_mrc_GetRegisterMode Manual(%c), mcc.%s mnc.%s"</span>,</div><div class="line">        (isManualOrigin ? <span class="charliteral">'Y'</span> : <span class="charliteral">'N'</span>),</div><div class="line">        mccStr, mncStr);</div><div class="line"></div><div class="line">    res = <a class="code" href="le__mrc__interface_8h.html#a09b890f05a20f4b007d60e595026631f">le_mrc_SetManualRegisterMode</a>(mccHomeStr, mncHomeStr);</div><div class="line"> <a class="code" href="le__log_8h.html#a4ebab29f40ee8eaaa87205fe3f9aaa13">LE_INFO</a>(<span class="stringliteral">"le_mrc_SetManualRegisterMode %s,%s return %d"</span>,mccHomeStr, mncHomeStr, res);</div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(res == LE_OK);</div><div class="line"></div><div class="line">    sleep(5);</div><div class="line"></div><div class="line">    memset(mccStr,0,LE_MRC_MCC_BYTES);</div><div class="line">    memset(mncStr,0,LE_MRC_MNC_BYTES);</div><div class="line">    res = <a class="code" href="le__mrc__interface_8h.html#a283c0c092c5a135a8e95f9f091655cb1">le_mrc_GetRegisterMode</a>(&isManual, mccStr, LE_MRC_MCC_BYTES, mncStr, LE_MRC_MNC_BYTES);</div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(res == LE_OK);</div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(isManual == <span class="keyword">true</span>);</div><div class="line">    cmpRes = strcmp(mccHomeStr, mccStr);</div><div class="line"> <a class="code" href="le__log_8h.html#a8d8f204806cd5fc0455fe3caacf1d251">LE_WARN_IF</a>(cmpRes, <span class="stringliteral">"Doesn't match mccHomeStr (%s) mccStr (%s)"</span>,mccHomeStr, mccStr)</div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(cmpRes == 0);</div><div class="line">    cmpRes = strcmp(mncHomeStr, mncStr);</div><div class="line"> <a class="code" href="le__log_8h.html#a8d8f204806cd5fc0455fe3caacf1d251">LE_WARN_IF</a>(cmpRes, "Doesn't match mncHomeStr (%s) mncStr (%s)",mncHomeStr, mncStr)</div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(cmpRes == 0);</div><div class="line"> <a class="code" href="le__log_8h.html#a4ebab29f40ee8eaaa87205fe3f9aaa13">LE_INFO</a>("<a class="code" href="le__mrc__interface_8h.html#a283c0c092c5a135a8e95f9f091655cb1">le_mrc_GetRegisterMode</a> Manual(Y), mcc.%s mnc.%s", mccStr, mncStr);</div><div class="line"></div><div class="line">    res = le_mrc_SetAutomaticRegisterMode();</div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(res == LE_OK);</div><div class="line"></div><div class="line">    sleep(5);</div><div class="line"></div><div class="line">    memset(mccStr,0,LE_MRC_MCC_BYTES);</div><div class="line">    memset(mncStr,0,LE_MRC_MNC_BYTES);</div><div class="line">    res = <a class="code" href="le__mrc__interface_8h.html#a283c0c092c5a135a8e95f9f091655cb1">le_mrc_GetRegisterMode</a>(&isManual, mccStr, LE_MRC_MCC_BYTES, mncStr, LE_MRC_MNC_BYTES);</div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(res == LE_OK);</div><div class="line"> <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(isManual == false);</div><div class="line"> <a class="code" href="le__log_8h.html#a4ebab29f40ee8eaaa87205fe3f9aaa13">LE_INFO</a>("<a class="code" href="le__mrc__interface_8h.html#a283c0c092c5a135a8e95f9f091655cb1">le_mrc_GetRegisterMode</a> Manual(N)");</div><div class="line">}</div></div><!-- fragment --></div></div>